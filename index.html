<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive XR Benchmarking Report - 2025 Update</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate Gray & Amber -->
    <!-- Application Structure Plan: A single-page application with a top navigation bar to switch between three main views: 'University Profiles', 'Overview & Comparison', and 'Key Trends'. This dashboard-like structure allows users to first dive into detailed information for each university, then get a high-level comparative understanding via charts, and finally synthesize the evolution of the field. The flow is designed to guide the user from specific details to broad comparison and then to overarching insights, which is a more intuitive way to consume a dense benchmarking report than a linear document. -->
    <!-- Visualization & Content Choices: 
        - Report Info: University XR Commitment/Investment Rating. Goal: Compare institutions directly. Viz: Interactive Bar Chart (Chart.js). Interaction: Hovering over bars shows the exact rating. Justification: A bar chart is the clearest way to compare a single quantitative metric across multiple entities. Library: Chart.js.
        - Report Info: Evolution of XR from 2020 to 2025. Goal: Illustrate the shift in focus and maturity. Viz: HTML/CSS based visual timeline. Interaction: Clicking on trend titles reveals descriptive text. Justification: A timeline is a natural and effective way to represent change over time, making the report's trend analysis more dynamic and engaging than a simple text list. Method: HTML/CSS with JS for interactivity.
        - Report Info: Detailed university profiles. Goal: Provide in-depth, organized information. Viz: Interactive HTML cards. Interaction: Clicking a university logo/name expands to show a detailed card with categorized information. Justification: This keeps the main view uncluttered while providing easy access to comprehensive data, preventing information overload. Method: HTML/CSS with JS for toggling visibility.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        .nav-button {
            transition: all 0.3s ease;
        }
        .nav-button.active {
            background-color: #ca8a04; /* yellow-600 */
            color: #ffffff;
            font-weight: 600;
        }
        .university-card {
            transition: all 0.3s ease;
            border: 1px solid #e2e8f0; /* slate-200 */
        }
        .university-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            border-color: #f59e0b; /* amber-500 */
        }
        .details-section {
            display: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .details-section.open {
            display: block;
            max-height: 2000px; /* Large enough for content */
        }
        .trend-item {
            cursor: pointer;
        }
        .trend-description {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, padding 0.5s ease-in-out;
            padding-top: 0;
            padding-bottom: 0;
        }
        .trend-description.open {
            max-height: 500px;
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .llm-output {
            background-color: #fefce8; /* yellow-50 */
            border-left: 4px solid #f59e0b; /* amber-500 */
            padding: 0.75rem;
            margin-top: 1rem;
            border-radius: 0.25rem;
            font-style: italic;
            color: #78350f; /* amber-900 */
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">

        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-900">University XR Capabilities</h1>
            <p class="text-lg text-slate-600 mt-2">An Interactive Benchmarking Report - 2025 Update</p>
        </header>

        <nav class="flex justify-center bg-slate-200 rounded-lg p-2 mb-8 sticky top-2 z-10 shadow-sm">
            <button id="nav-profiles" class="nav-button active px-4 py-2 rounded-md text-sm sm:text-base">University Profiles</button>
            <button id="nav-overview" class="nav-button px-4 py-2 rounded-md text-sm sm:text-base">Overview & Comparison</button>
        </nav>

        <main>
            <section id="profiles" class="space-y-12">
                 <div class="text-center mb-8">
                    <h2 class="text-2xl font-semibold text-slate-800">Detailed University Profiles</h2>
                    <p class="text-slate-600 mt-2 max-w-3xl mx-auto">Explore the specific XR initiatives at each peer institution. Click on any university to expand its profile and view detailed information about its investments, facilities, research programs, staffing, and industry partnerships.</p>
                </div>
                <div id="university-profiles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            </section>

            <section id="overview" class="hidden space-y-12">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-semibold text-center mb-4 text-slate-800">XR Commitment/Investment Rating (2025)</h2>
                    <p class="text-center text-slate-600 mb-6 max-w-3xl mx-auto">This chart provides a comparative overview of the strategic commitment and investment each university has made in Extended Reality. The rating, on a scale of 1 to 5, synthesizes factors like funding, dedicated facilities, program depth, and industry integration. Use this to quickly identify leaders and emerging players in the academic XR space.</p>
                    <div class="chart-container">
                        <canvas id="commitmentChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow text-center">
                    <h2 class="text-2xl font-semibold mb-4 text-slate-800">NYU Strategic Insights</h2>
                    <p class="text-slate-600 mb-6 max-w-3xl mx-auto">Leverage AI to get a strategic recommendation for NYU's future in XR, based on the comprehensive benchmarking data and key industry trends.</p>
                    <button id="nyu-strategic-recommendation-btn" class="px-6 py-3 bg-amber-500 text-white rounded-md hover:bg-amber-600 transition-colors duration-200 text-lg font-medium">✨ Get NYU Strategic Recommendation</button>
                    <div id="nyu-strategic-recommendation-output" class="llm-output mt-4 hidden text-left"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        const globalReferences = {
            1: "https://www.cmu.edu/xrtc/",
            2: "https://xraccess.org/",
            3: "https://xrc.infosci.cornell.edu/",
            4: "https://medschool.duke.edu/education/graduate-medical-education/vr-heal",
            5: "https://harvardxr.org/augmented-self-2025",
            6: "https://xri.iu.edu/",
            7: "https://ai.jhu.edu/event/privacy-and-liberty-in-the-age-of-ai-and-immersive-technologies-plaits-conference/",
            8: "https://news.mit.edu/topic/virtual-reality",
            9: "https://engineering.nyu.edu/research-innovation/labs-centers/holodeck",
            10: "https://cie.psu.edu/",
            11: "https://princetonuniversityconcerts.org/events/future-presence",
            12: "https://www.purdue.edu/newsroom/releases/2025/Q1/purdue-university-in-indianapolis-launches-collab-xr-program.html",
            13: "https://xr.stanford.edu/conference/",
            14: "https://duderstadt.umich.edu/services/visualization-studio/",
            15: "https://xrpeds.yale.edu/",
            16: "https://www.cmu.edu/block-center/about/transition-2024-2025/",
            17: "https://www.nyu.edu/about/leadership-university-administration/office-of-the-provost/academic-technology/high-speed-research-network.html",
            18: "https://www.tc.columbia.edu/events/info/immersive-experience-club-11436743/",
            19: "https://www.engineering.columbia.edu/about/news/leveling-accessibility-video-games",
            20: "https://cmac.duke.edu/faculty-labs/xr-studio/",
            21: "https://ece.duke.edu/faculty/maria-gorlatova",
            22: "https://awexr.com/usa-2025/agenda/",
            23: "https://www.harvardxr.com/2025/program",
            24: "https://www.linkedin.com/company/harvardxr/",
            25: "https://library.harvard.edu/services-tools/augmented-and-virtual-reality-studio",
            26: "https://www.harvardxr.com/2025/program",
            27: "https://atg.fas.harvard.edu/",
            28: "https://www.iu.edu/news/stories/2023/08/iu-purdue-indianapolis-split-timeline.html",
            29: "https://www.wdlsystems.com/trade-shows",
            30: "https://advanced.jhu.edu/news/innovative-technology-enables-emotional-storytelling/",
            31: "https://digitalmedia.jhu.edu/",
            32: "https://mitnano.mit.edu/research-capabilities",
            33: "https://actionlab.sites.northeastern.edu/2025/01/30/mahdi-wins-2025-mit-reality-hackathon/",
            34: "https://mitnano.mit.edu/immersion-lab",
            35: "https://engineering.nyu.edu/research-innovation/labs-centers/holodeck",
            36: "https://www.nyu.edu/students/student-life/technology-and-internet/it-labs/immersive-technology-lab.html",
            37: "https://engineering.nyu.edu/academics/programs/summer-programs/xr-extending-reality-through-virtual-worlds",
            38: "https://cie.psu.edu/",
            39: "https://behrend.psu.edu/academics/academic-majors/school-engineering/virtual-augmented-reality-lab",
            40: "https://cie.psu.edu/courses-and-grants",
            41: "https://library.princeton.edu/stokes/vr",
            42: "https://sgs.princeton.edu/projects/nuclear-crisis-simulation",
            43: "https://www.purdue.edu/innovationhub/collab-xr/",
            44: "https://polytechnic.purdue.edu/degrees/computer-graphics-technology/virtual-reality-lab",
            45: "https://vhil.stanford.edu/",
            46: "https://cs.stanford.edu/courses/cs377/",
            47: "https://innovationpartnerships.umich.edu/",
            48: "https://www.xrmidwest.org/",
            49: "https://ai.umich.edu/extended-reality/",
            50: "https://www.si.umich.edu/people/michael-nebeling",
            51: "https://innovationpartnerships.umich.edu/news/innovation-partnerships-supports-extended-reality-xr-initiatives/",
            52: "https://medicine.yale.edu/childstudy/ccam/fellowship/",
            53: "https://ccam.yale.edu/",
            54: "https://xrpeds.yale.edu/about-us/supporters",
            55: "https://ccam.yale.edu/exhibitions/ccam-studio-fellowship-exhibition-2024–2025",
            56: "https://www.nyu.edu/about/leadership-university-administration/office-of-the-provost/academic-technology/high-speed-research-network.html"
        };

        // Function to replace [X] with hyperlinks
        function applyReferences(text) {
            return text.replace(/\[(\d+)\]/g, (match, p1) => {
                const refId = parseInt(p1);
                const url = globalReferences[refId];
                if (url) {
                    return `<a href="${url}" target="_blank" class="text-blue-600 hover:underline">[${refId}]</a>`;
                }
                return match; // Return original if no URL found
            });
        }

        const universityData = [
            { name: 'Carnegie Mellon', rating: 4, details: { investments: 'Strategic focus on AI/XR via Block Center; funding for advanced immersive tech research. [1, 16]', facilities: 'Dedicated XR Technology Center (XRTC) for immersive tech research and development. [1]', research: 'XRTC drives immersive tech research; Block Center explores AI/XR in education/healthcare. [1, 16]', staff: 'XRTC and Block Center likely have dedicated personnel, though specific numbers aren\'t detailed.', partnerships: 'Collaboration with Fujitsu on 3D scene reconstruction research. [1]' } },
            { name: 'Columbia', rating: 3, details: { investments: 'Continued support for XR accessibility research and immersive learning initiatives. [2, 18]', facilities: 'Computer-Enabled Abilities Laboratory (CEAL) for game accessibility research; Immersive Learning Initiative facilities. [2, 18, 19]', research: 'CEAL focuses on accessible video games; Immersive Learning Initiative explores VR/AR in education. [2, 18]', staff: 'Brian A. Smith directs CEAL; Immersive Learning Initiative has instructional designers. [2, 18]', partnerships: 'CEAL collaborates with companies; XR Access Symposium involves Meta Reality Labs. [2]' } },
            { name: 'Cornell', rating: 4, details: { investments: 'Significant investment in XR Collaboratory courses and diverse XR research labs. [3]', facilities: 'XR Collaboratory, Design & Augmented Intelligence Lab, Virtual Embodiment Lab, others. [3]', research: 'Robust XR Collaboratory courses (3D Interaction Design, VR/AR); diverse lab research. [3]', staff: 'Harald Haraldsson directs XR Collaboratory; numerous faculty across disciplines. [3]', partnerships: 'Not explicitly detailed for 2025, but XR Access Symposium involves industry leaders. [2, 3]' } },
            { name: 'Duke', rating: 4, details: { investments: 'Significant investment in medical education XR, particularly VR-HEAL project. [4]', facilities: 'XR Studio for computational media; VR-HEAL developing haptic gloves, virtual OR. [4, 20]', research: 'VR-HEAL focuses on interventional radiology training; Dr. Gorlatova researches next-gen AR. [4, 21]', staff: 'VR-HEAL has team leaders, graduate members, and contributors; Dr. Maria Gorlatova. [4, 21]', partnerships: 'Dr. Gorlatova speaks at AWE USA 2025; Apple Workshop on Human-Centered ML. [21, 22]' } },
            { name: 'Harvard', rating: 4, details: { investments: 'HarvardXR non-profit organization supports annual conferences, exploring XR/AI boundaries. [23, 24]', facilities: 'Cabot Science Library\'s "The Hive" offers Valve Index, HTC Vive, and software. [25]', research: 'HarvardXR conference promotes discussion on XR\'s future in various industries. [23, 26]', staff: 'HarvardXR has co-leads and a large core team; Academic Technology for FAS supports XR use. [23, 24, 27]', partnerships: 'HarvardXR conference sponsored by SnapAR, Uber, Microsoft, Meta, Samsung, Pico XR. [23]' } },
            { name: 'Indiana (IUI)', rating: 4, details: { investments: 'Significant XRI Faculty Fellow grants for 2024/2025 to integrate XR into diverse courses. [6]', facilities: 'IU Indianapolis University Library VR Lab; access to Oculus Quest, MERGE Cube, Google Cardboard. [6]', research: 'XRI supports new courses (e.g., "XR for Social Good," VR Anatomy, pediatric dental AR/VR). [6]', staff: 'Numerous faculty across various schools are XRI grant recipients, actively developing XR curricula. [6]', partnerships: 'XR Initiative is a collaboration among multiple units; sponsors include UITS, Advanced Visualization Lab. [6]' } },
            { name: 'Johns Hopkins', rating: 4, details: { investments: 'XR Collaboration Center sponsors symposium; ongoing research in immersive storytelling and AI. [29, 30]', facilities: 'Applied Physics Laboratory (APL) hosts XR Symposium; Digital Media Center is a multimedia lab. [29, 31]', research: 'MA in Film and Media (Immersive Storytelling); APL conducts XR research; PLAITS conference on AI/immersive tech. [7, 30]', staff: 'Digital Media Center has professional and student staff; APL has XR Collaboration Center. [29, 31]', partnerships: 'APL\'s XR Symposium involves sponsors/collaborators; Connect Tech showcases NVIDIA Jetson modules. [29]' } },
            { name: 'MIT', rating: 5, details: { investments: 'MIT.nano Immersion Lab for AR/VR prototyping; Reality Hackathon and related events. [32, 33]', facilities: 'MIT.nano Immersion Lab with AR/VR, high-performance workstations, motion capture. [32, 34]', research: 'Extensive VR/AR research across departments; "How to think like a VR developer" workshop. [8, 32]', staff: 'Talis Reks (AR/VR/Gaming Technologist); Y. Jenny Wang (Lecturer, XR developer); MIT.nano staff. [32]', partnerships: 'MIT.nano Immersion Lab Gaming Program with NCSOFT; Reality Hack involves brand mentors. [32, 33]' } },
            { name: 'NYU', rating: 4, details: { investments: 'City-funded RLab; Holodeck project for VR research; ITLab support. [17, 35, 36]', facilities: 'Holodeck for VR research; RLab for VR/AR; ITLab for immersive tech. [17, 35, 36]', research: 'Holodeck fosters VR research; RLab for research/education; ITLab offers VR workshops. [17, 35, 36]', staff: 'Learning Experience Design developers; ITLab staff; Holodeck interdisciplinary team. [17, 35, 36]', partnerships: 'RLab is city-funded; Holodeck links Future Reality Lab, MAGNET. [17, 35]' } },
            { name: 'Penn State', rating: 4, details: { investments: 'Center for Immersive Experiences (CIE) with NSF grants; focus on transforming education. [38]', facilities: 'CIE provides facilities; IMEX Lab for 360 video; VAR Lab with Matchbox, XRcast Studios. [17, 38, 39]', research: 'CIE offers courses/grants; VAR Lab enhances learning, recreates historical venues. [17, 39, 40]', staff: 'CIE is "well-staffed"; VAR Lab and TLT collaborate on XR Catalog. [17, 38, 39]', partnerships: 'National Science Foundation supports industrial engineering simulation; VAR Lab seeks partnerships. [17, 38, 39]' } },
            { name: 'Princeton', rating: 3, details: { investments: 'Stokes Library VR studio; "Future Presence" VR/spatial sound installation. [11, 41]', facilities: 'Stokes Library VR Studio (Meta Quest 3 headsets); Woolworth Music Building for "Future Presence." [11, 41]', research: 'Science and Global Security Lab\'s nuclear crisis VR simulation (pre-2023); "Future Presence" explores music via VR. [11, 17, 42]', staff: 'Science and Global Security Lab has 9 staff; Stokes Library VR program has dedicated staff. [17, 41]', partnerships: 'Mahler Chamber Orchestra (MCO) partnered for "Future Presence." [11]' } },
            { name: 'Purdue (IUI)', rating: 4, details: { investments: 'Envision Center\'s Collab XR program for academic XR experiences; VR Lab at Polytechnic Institute. [12, 43]', facilities: 'Envision Center\'s Collab XR platform (Meta Quest 3); Polytechnic Institute\'s VR Lab with state-of-the-art devices. [12, 44]', research: 'Collab XR focuses on scientific 3D data visualization and immersive learning scenarios. [12, 43]', staff: 'Envision Center has a director, technical director, visual solutions engineers; Polytechnic VR Lab has faculty contact. [43, 44]', partnerships: 'Purdue Innovation Hub partners with Envision Center for Collab XR. [43]' } },
            { name: 'Stanford', rating: 5, details: { investments: 'Long-standing Virtual Human Interaction Lab (VHIL); Stanford XR Conference with industry sponsors. [13, 45]', facilities: 'VHIL has dedicated lab space; "Designing for Extended Realities" course provides XR devices. [45, 46]', research: 'VHIL researches psychological/behavioral effects of VR/AR; "Designing for Extended Realities" course. [45, 46]', staff: 'VHIL has founding director, PhD students, visiting scholars; course instructors and industry mentors. [45, 46]', partnerships: 'Stanford XR Conference sponsors include SnapAR, Uber, Microsoft, Meta. [13]' } },
            { name: 'U of Michigan', rating: 5, details: { investments: 'Innovation Partnerships supports XR; XR Midwest hackathon provides hardware, mentorship. [47, 48]', facilities: 'Duderstadt Center\'s Visualization Studio (M.I.D.E.N., 30+ workstations, various headsets). [14]', research: 'Center for Academic Innovation has 3 dozen XR projects; UMSI Interaction Lab researches AR/VR/MR. [49, 50]', staff: 'Jessi Kittel (XR Project Lead); Ted Hall (XR Visualization Specialist); Michael Nebeling (UMSI Interaction Lab Director). [47, 50]', partnerships: 'XR Midwest partners with Center for Academic Innovation; Innovation Partnerships facilitates commercial advancement. [48, 51]' } },
            { name: 'Yale', rating: 4, details: { investments: 'Yale Center for Immersive Technologies in Pediatrics; CCAM Studio Fellowship. [15, 52]', facilities: 'XRPeds Lab; Center for Collaborative Arts and Media (CCAM) with motion capture studio. [15, 53]', research: 'XRPeds focuses on health interventions for youth; CCAM investigates art/science/tech intersections. [15, 53]', staff: 'XRPeds has a leadership team and numerous collaborators; CCAM led by Dana Karwas. [15, 53]', partnerships: 'XRPeds supported by Unity Technologies; Blended Reality project with HP (pre-2023). [17, 54]' } }
        ];

        // Removed trendsData as the section is removed.

        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('.nav-button');
            const sections = {
                profiles: document.getElementById('profiles'),
                overview: document.getElementById('overview')
            };

            // Set initial active section and button
            switchView('profiles');

            function switchView(view) {
                Object.values(sections).forEach(section => section.classList.add('hidden'));
                navButtons.forEach(btn => btn.classList.remove('active'));

                sections[view].classList.remove('hidden');
                document.getElementById(`nav-${view}`).classList.add('active');
            }

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const view = button.id.split('-')[1];
                    switchView(view);
                });
            });

            function createCommitmentChart() {
                const ctx = document.getElementById('commitmentChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: universityData.map(u => u.name),
                        datasets: [{
                            label: 'XR Commitment/Investment Rating (1-5)',
                            data: universityData.map(u => u.rating),
                            backgroundColor: 'rgba(245, 158, 11, 0.6)', // amber-500
                            borderColor: 'rgba(245, 158, 11, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 5,
                                grid: { color: '#e2e8f0' }
                            },
                            x: {
                                grid: { display: false }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    title: (tooltipItems) => tooltipItems[0].label,
                                    label: (tooltipItem) => `Rating: ${tooltipItem.raw}`
                                }
                            }
                        }
                    }
                });
            }

            // Removed generateStrategicInsight function
            // Removed suggestResearchAreas function

            async function getNyuStrategicRecommendation(nyuData, allUniData, outputElement) {
                outputElement.innerHTML = '<span class="text-slate-500">Generating recommendation for NYU...</span>';
                const allUniversitiesSummary = allUniData.map(u => `${u.name} (Rating: ${u.rating})`).join('; ');
                // Removed trendsData from prompt as the section is removed.

                const prompt = `Based on the following benchmarking data for NYU and its peer universities, provide a strategic recommendation for NYU's next steps in Extended Reality (XR). Focus on leveraging its strengths, addressing potential gaps, and aligning with future trends. Keep the recommendation concise (maximum 100 words).

                NYU's Data:
                Investments: ${nyuData.details.investments}
                Facilities & Equipment: ${nyuData.details.facilities}
                Research & Programs: ${nyuData.details.research}
                Dedicated Staff: ${nyuData.details.staff}
                Industry Partnerships: ${nyuData.details.partnerships}
                Rating: ${nyuData.rating}

                Peer University Summary: ${allUniversitiesSummary}

                Strategic Recommendation for NYU:`;

                try {
                    let chatHistory = [];
                    chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                    const payload = { contents: chatHistory };
                    const apiKey = "";
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                    const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });
                    const result = await response.json();
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const text = result.candidates[0].content.parts[0].text;
                        outputElement.innerHTML = text;
                    } else {
                        outputElement.innerHTML = 'Failed to generate recommendation.';
                    }
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    outputElement.innerHTML = 'Error generating recommendation. Please try again.';
                }
            }


            function populateUniversityProfiles() {
                const container = document.getElementById('university-profiles-container');
                universityData.forEach(uni => {
                    const card = document.createElement('div');
                    card.className = 'university-card bg-white rounded-lg shadow-md cursor-pointer';
                    card.innerHTML = `
                        <div class="p-4 flex justify-between items-center">
                            <h3 class="text-lg font-semibold text-slate-800">${uni.name} <span class="text-sm text-slate-500">(Rating: ${uni.rating}/5)</span></h3>
                            <span class="text-2xl text-amber-500 transform transition-transform duration-300">&#x25BC;</span>
                        </div>
                        <div class="details-section px-4 pb-4 text-slate-600">
                            <div class="border-t border-slate-200 pt-4 space-y-3">
                                <p><strong>Investments:</strong> ${applyReferences(uni.details.investments)}</p>
                                <p><strong>Facilities & Equipment:</strong> ${applyReferences(uni.details.facilities)}</p>
                                <p><strong>Research & Programs:</strong> ${applyReferences(uni.details.research)}</p>
                                <p><strong>Dedicated Staff:</strong> ${applyReferences(uni.details.staff)}</p>
                                <p><strong>Industry Partnerships:</strong> ${applyReferences(uni.details.partnerships)}</p>
                                <div class="llm-output mt-2 hidden"></div>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);

                    card.addEventListener('click', (event) => {
                        // Only toggle details if the click is not on a link
                        if (event.target.tagName !== 'A') {
                            const details = card.querySelector('.details-section');
                            const arrow = card.querySelector('span');
                            const isOpen = details.classList.toggle('open');
                            arrow.style.transform = isOpen ? 'rotate(180deg)' : 'rotate(0deg)';
                        }
                    });
                });
            }

            // Removed populateTrends function

            // NYU Strategic Recommendation Button
            const nyuStrategicRecommendationBtn = document.getElementById('nyu-strategic-recommendation-btn');
            const nyuStrategicRecommendationOutput = document.getElementById('nyu-strategic-recommendation-output');
            const nyuData = universityData.find(uni => uni.name === 'NYU');

            if (nyuStrategicRecommendationBtn && nyuData) {
                nyuStrategicRecommendationBtn.addEventListener('click', () => {
                    nyuStrategicRecommendationOutput.classList.remove('hidden');
                    getNyuStrategicRecommendation(nyuData, universityData, nyuStrategicRecommendationOutput);
                });
            }


            createCommitmentChart();
            populateUniversityProfiles();
            // Removed populateTrends();
        });
    </script>
</body>
</html>
